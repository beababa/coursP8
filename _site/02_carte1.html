<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cours P8 2024 - Première carte de la ville</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Cours P8 2024</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./01_intro.html" rel="" target="">
 <span class="menu-text">Introduction |</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./02_carte1.html" rel="" target="" aria-current="page">
 <span class="menu-text">Première carte |</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./03_bv.html" rel="" target="">
 <span class="menu-text">Bureaux de vote |</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./04_rueBat.html" rel="" target="">
 <span class="menu-text">Rues et bâtiments |</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/beababa/coursP8" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#objectif" id="toc-objectif" class="nav-link active" data-scroll-target="#objectif"><span class="header-section-number">1</span> Objectif</a></li>
  <li><a href="#e-saisie-pour-comprendre" id="toc-e-saisie-pour-comprendre" class="nav-link" data-scroll-target="#e-saisie-pour-comprendre"><span class="header-section-number">2</span> 1e saisie pour comprendre</a>
  <ul class="collapse">
  <li><a href="#interface-josm" id="toc-interface-josm" class="nav-link" data-scroll-target="#interface-josm"><span class="header-section-number">2.1</span> Interface JOSM</a></li>
  <li><a href="#primitives-géométriques-noeud-et-chemin" id="toc-primitives-géométriques-noeud-et-chemin" class="nav-link" data-scroll-target="#primitives-géométriques-noeud-et-chemin"><span class="header-section-number">2.2</span> Primitives géométriques : noeud et chemin</a></li>
  <li><a href="#la-relation" id="toc-la-relation" class="nav-link" data-scroll-target="#la-relation"><span class="header-section-number">2.3</span> La relation</a></li>
  <li><a href="#tag-clé-valeur" id="toc-tag-clé-valeur" class="nav-link" data-scroll-target="#tag-clé-valeur"><span class="header-section-number">2.4</span> Tag = clé + valeur</a></li>
  <li><a href="#outil-de-qualité" id="toc-outil-de-qualité" class="nav-link" data-scroll-target="#outil-de-qualité"><span class="header-section-number">2.5</span> outil de qualité</a></li>
  </ul></li>
  <li><a href="#extractions-diverses-osm" id="toc-extractions-diverses-osm" class="nav-link" data-scroll-target="#extractions-diverses-osm"><span class="header-section-number">3</span> Extractions diverses OSM</a>
  <ul class="collapse">
  <li><a href="#quels-tags" id="toc-quels-tags" class="nav-link" data-scroll-target="#quels-tags"><span class="header-section-number">3.1</span> Quels tags ?</a></li>
  <li><a href="#overpass-pour-extraire" id="toc-overpass-pour-extraire" class="nav-link" data-scroll-target="#overpass-pour-extraire"><span class="header-section-number">3.2</span> Overpass pour extraire</a></li>
  <li><a href="#autres-extractions" id="toc-autres-extractions" class="nav-link" data-scroll-target="#autres-extractions"><span class="header-section-number">3.3</span> Autres extractions</a></li>
  </ul></li>
  <li><a href="#autres-données" id="toc-autres-données" class="nav-link" data-scroll-target="#autres-données"><span class="header-section-number">4</span> Autres données</a></li>
  <li><a href="#carte-1-les-rues-et-les-bâtiments-osm-sous-qgis" id="toc-carte-1-les-rues-et-les-bâtiments-osm-sous-qgis" class="nav-link" data-scroll-target="#carte-1-les-rues-et-les-bâtiments-osm-sous-qgis"><span class="header-section-number">5</span> CARTE 1 : les rues et les bâtiments OSM sous QGIS</a>
  <ul class="collapse">
  <li><a href="#savoir-faire-qgis" id="toc-savoir-faire-qgis" class="nav-link" data-scroll-target="#savoir-faire-qgis"><span class="header-section-number">5.1</span> Savoir-faire QGIS</a></li>
  <li><a href="#consignes" id="toc-consignes" class="nav-link" data-scroll-target="#consignes"><span class="header-section-number">5.2</span> Consignes</a>
  <ul class="collapse">
  <li><a href="#les-couches" id="toc-les-couches" class="nav-link" data-scroll-target="#les-couches"><span class="header-section-number">5.2.1</span> Les couches</a></li>
  <li><a href="#les-contours-de-la-commune" id="toc-les-contours-de-la-commune" class="nav-link" data-scroll-target="#les-contours-de-la-commune"><span class="header-section-number">5.2.2</span> Les contours de la commune</a></li>
  <li><a href="#les-étiquettes-des-rues" id="toc-les-étiquettes-des-rues" class="nav-link" data-scroll-target="#les-étiquettes-des-rues"><span class="header-section-number">5.2.3</span> Les étiquettes des rues</a></li>
  <li><a href="#mise-en-page" id="toc-mise-en-page" class="nav-link" data-scroll-target="#mise-en-page"><span class="header-section-number">5.2.4</span> Mise en page</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Première carte de la ville</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="objectif" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Objectif</h1>
<p>Faire une première extraction des données OSM pour établir une carte. cela permet d’appréhender OSM et Qgis.</p>
</section>
<section id="e-saisie-pour-comprendre" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> 1e saisie pour comprendre</h1>
<section id="interface-josm" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="interface-josm"><span class="header-section-number">2.1</span> Interface JOSM</h2>
<p><a href="https://manual.inasafe.org/_images/4_017.png">interface (panneaux)</a></p>
<p>Attention, clic droit pour se déplacer</p>
</section>
<section id="primitives-géométriques-noeud-et-chemin" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="primitives-géométriques-noeud-et-chemin"><span class="header-section-number">2.2</span> Primitives géométriques : noeud et chemin</h2>
<p>Ouvrir une page vierge sous JOSM et créer un triangle avec 3 noeuds en utilisant les modes :</p>
<ul>
<li>a pour ajout</li>
<li>s pour sélection</li>
<li>w pour write</li>
</ul>
<p>Faire le triangle, ajouter un point, le déformer.</p>
</section>
<section id="la-relation" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="la-relation"><span class="header-section-number">2.3</span> La relation</h2>
<p>Il existe une 3e primitive, plus difficile à utiliser, la relation. Elle est utilisée pour construire les itinéraires de bus par exemple. On verra, pour les bureaux de vote, qu’elle sert à lier le bureau et sa zone.</p>
</section>
<section id="tag-clé-valeur" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="tag-clé-valeur"><span class="header-section-number">2.4</span> Tag = clé + valeur</h2>
<p>https://taginfo.openstreetmap.org/</p>
<p>on utilise directement l’éditeur intégré id sur osm.org trouver le tag directement à partir de l’éditeur.</p>
<p>exercice 1 : faire une saisie sur un point connu</p>
<p>exercice 2 : faire une saisie sur un <a href="img/pmr.html">point pmr</a> sur Bondy, attention à la concordance image aérienne et carte terrain.</p>
<p><img src="img/pmrPHOTO.png" class="img-fluid"></p>
</section>
<section id="outil-de-qualité" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="outil-de-qualité"><span class="header-section-number">2.5</span> outil de qualité</h2>
<p><a href="https://resultmaps.neis-one.org/osm-changesets?comment=paris8#4/32.58/-6.77">utilisation du changeset</a></p>
<p><a href="https://resultmaps.neis-one.org/oooc?zoom=15&amp;lat=48.90494&amp;lon=2.493&amp;layers=BTFFFFFT&amp;contributors=TTTTFF">carte des utilisateurs</a></p>
<p>Voir les saisies pmr effectuées par les étudiants avec overpass turbo</p>
<p>également dans <a href="http://osmose.openstreetmap.fr/fr/map/#zoom=16&amp;lat=48.90695&amp;lon=2.49237">osmose</a></p>
<p>Mais le mieux reste :</p>
<p><a href="https://www.openstreetmap.org/history#map=18/48.916214/2.486000">historique dans openstreetmap.org</a></p>
</section>
</section>
<section id="extractions-diverses-osm" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Extractions diverses OSM</h1>
<section id="quels-tags" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="quels-tags"><span class="header-section-number">3.1</span> Quels tags ?</h2>
<p>rues et bâtiments, aller dans taginfo. Quelles sont les principales valeurs ?</p>
</section>
<section id="overpass-pour-extraire" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="overpass-pour-extraire"><span class="header-section-number">3.2</span> Overpass pour extraire</h2>
<p>Il existe beaucoup d’outils, y compris intégrés dans Qgis.</p>
<p>Utiliser l’assistant et extraire rues et bâtiments avec le caractère joker.</p>
<ul>
<li><p>comment limiter l’extraction à Bondy</p></li>
<li><p>quel est ce caractère ?</p></li>
<li><p>attention au <em>et</em></p></li>
</ul>
</section>
<section id="autres-extractions" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="autres-extractions"><span class="header-section-number">3.3</span> Autres extractions</h2>
<ul>
<li><p>les bureaux de vote (boundary=political)</p></li>
<li><p>et les limites de la commune (admin_level=8)</p></li>
</ul>
</section>
</section>
<section id="autres-données" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Autres données</h1>
<p>On va également utiliser le cadastre en opendata sur data.gouv, le télécharger pour la ville (code INSEE 93010)</p>
<p>Enfin en fond de carte, on affichera OSM Positron obtenu à partir du <a href="https://plugins.qgis.org/plugins/popular/">plugin</a></p>
</section>
<section id="carte-1-les-rues-et-les-bâtiments-osm-sous-qgis" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> CARTE 1 : les rues et les bâtiments OSM sous QGIS</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Avant de faire la carte, quizz !</p>
</div>
</div>
<section id="savoir-faire-qgis" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="savoir-faire-qgis"><span class="header-section-number">5.1</span> Savoir-faire QGIS</h2>
<ul>
<li><p>mettre un favori dans l’explorateur sur le répertoire Téléchargement</p></li>
<li><p>intégrer une couche dans Qgis</p></li>
<li><p>étiquetage des rues sous Qgis</p></li>
</ul>
<p><img src="img/rue.png" class="img-fluid"></p>
<ul>
<li><p>style en polygone inversé et remplissage dégradé suivant la forme (ou plugin mask)</p></li>
<li><p>mise en page qgis (3 boutons)</p></li>
</ul>
</section>
<section id="consignes" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="consignes"><span class="header-section-number">5.2</span> Consignes</h2>
<section id="les-couches" class="level3" data-number="5.2.1">
<h3 data-number="5.2.1" class="anchored" data-anchor-id="les-couches"><span class="header-section-number">5.2.1</span> Les couches</h3>
<p><img src="img/couchesCarte1.png" class="img-fluid"></p>
<p>Le cadastre sert de fond afin de faire ressortir les axes, du coup, pas de symbole pour les rues uniquement des étiquettes. Pas d’utilisation de la donnée ponctuelle Fond positron (plugin Qgis)</p>
</section>
<section id="les-contours-de-la-commune" class="level3" data-number="5.2.2">
<h3 data-number="5.2.2" class="anchored" data-anchor-id="les-contours-de-la-commune"><span class="header-section-number">5.2.2</span> Les contours de la commune</h3>
<p>Tag = admin_level=8 in Bondy</p>
<p>style en polygone inversé et remplissage dégradé suivant la forme (ou plugin mask)</p>
</section>
<section id="les-étiquettes-des-rues" class="level3" data-number="5.2.3">
<h3 data-number="5.2.3" class="anchored" data-anchor-id="les-étiquettes-des-rues"><span class="header-section-number">5.2.3</span> Les étiquettes des rues</h3>
<p>une police condensée / étroite et une position incurvée sur la ligne</p>
</section>
<section id="mise-en-page" class="level3" data-number="5.2.4">
<h3 data-number="5.2.4" class="anchored" data-anchor-id="mise-en-page"><span class="header-section-number">5.2.4</span> Mise en page</h3>
<p>classique&nbsp;: titre / échelle / crédits</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>